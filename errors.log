Invalid HTTP_HOST header: '127.0.0.1:8000'. You may need to add '127.0.0.1' to ALLOWED_HOSTS.
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\utils\deprecation.py", line 128, in __call__
    response = self.process_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\middleware\common.py", line 48, in process_request
    host = request.get_host()
           ^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\http\request.py", line 151, in get_host
    raise DisallowedHost(msg)
django.core.exceptions.DisallowedHost: Invalid HTTP_HOST header: '127.0.0.1:8000'. You may need to add '127.0.0.1' to ALLOWED_HOSTS.
Internal Server Error: /update-current-date/
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\sqlite3\base.py", line 354, in execute
    return super().execute(query, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlite3.OperationalError: database is locked

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\views\decorators\http.py", line 64, in inner
    return func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\views.py", line 15, in update_current_date
    product = StructuredProduct.objects.first()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 1097, in first
    for obj in queryset[:1]:
               ~~~~~~~~^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 400, in __iter__
    self._fetch_all()
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 1928, in _fetch_all
    self._result_cache = list(self._iterable_class(self))
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 91, in __iter__
    results = compiler.execute_sql(
              ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\sql\compiler.py", line 1574, in execute_sql
    cursor.execute(sql, params)
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 122, in execute
    return super().execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\sqlite3\base.py", line 354, in execute
    return super().execute(query, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
django.db.utils.OperationalError: database is locked
Internal Server Error: /holdings/
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\sqlite3\base.py", line 354, in execute
    return super().execute(query, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlite3.OperationalError: database is locked

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\views\generic\base.py", line 143, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\views.py", line 32, in get
    service.update_holdings()
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\services\holding_service.py", line 19, in update_holdings
    prices = self.loader.load_prices()
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\services\data_loader.py", line 30, in load_prices
    Index.objects.get_or_create(
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 948, in get_or_create
    return self.get(**kwargs), False
           ^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 645, in get
    num = len(clone)
          ^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 382, in __len__
    self._fetch_all()
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 1928, in _fetch_all
    self._result_cache = list(self._iterable_class(self))
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 91, in __iter__
    results = compiler.execute_sql(
              ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\sql\compiler.py", line 1574, in execute_sql
    cursor.execute(sql, params)
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 122, in execute
    return super().execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\sqlite3\base.py", line 354, in execute
    return super().execute(query, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
django.db.utils.OperationalError: database is locked
Internal Server Error: /
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\sqlite3\base.py", line 354, in execute
    return super().execute(query, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlite3.OperationalError: database is locked

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\views\generic\base.py", line 143, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\views.py", line 32, in get
    service.update_holdings()
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\services\holding_service.py", line 19, in update_holdings
    prices = self.loader.load_prices()
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\services\data_loader.py", line 30, in load_prices
    Index.objects.get_or_create(
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 948, in get_or_create
    return self.get(**kwargs), False
           ^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 645, in get
    num = len(clone)
          ^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 382, in __len__
    self._fetch_all()
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 1928, in _fetch_all
    self._result_cache = list(self._iterable_class(self))
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 91, in __iter__
    results = compiler.execute_sql(
              ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\sql\compiler.py", line 1574, in execute_sql
    cursor.execute(sql, params)
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 122, in execute
    return super().execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\sqlite3\base.py", line 354, in execute
    return super().execute(query, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
django.db.utils.OperationalError: database is locked
Internal Server Error: /update-current-date/
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\sqlite3\base.py", line 354, in execute
    return super().execute(query, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlite3.OperationalError: database is locked

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\views\decorators\http.py", line 64, in inner
    return func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\views.py", line 15, in update_current_date
    product = StructuredProduct.objects.first()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 1097, in first
    for obj in queryset[:1]:
               ~~~~~~~~^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 400, in __iter__
    self._fetch_all()
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 1928, in _fetch_all
    self._result_cache = list(self._iterable_class(self))
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 91, in __iter__
    results = compiler.execute_sql(
              ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\sql\compiler.py", line 1574, in execute_sql
    cursor.execute(sql, params)
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 122, in execute
    return super().execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\sqlite3\base.py", line 354, in execute
    return super().execute(query, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
django.db.utils.OperationalError: database is locked
Internal Server Error: /update-current-date/
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\sqlite3\base.py", line 354, in execute
    return super().execute(query, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlite3.OperationalError: database is locked

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\views\decorators\http.py", line 64, in inner
    return func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\views.py", line 15, in update_current_date
    product = StructuredProduct.objects.first()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 1097, in first
    for obj in queryset[:1]:
               ~~~~~~~~^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 400, in __iter__
    self._fetch_all()
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 1928, in _fetch_all
    self._result_cache = list(self._iterable_class(self))
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 91, in __iter__
    results = compiler.execute_sql(
              ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\sql\compiler.py", line 1574, in execute_sql
    cursor.execute(sql, params)
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 122, in execute
    return super().execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\sqlite3\base.py", line 354, in execute
    return super().execute(query, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
django.db.utils.OperationalError: database is locked
"GET /holdings/ HTTP/1.1" 500 166439
"GET / HTTP/1.1" 500 166479
Internal Server Error: /holdings/
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\sqlite3\base.py", line 354, in execute
    return super().execute(query, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlite3.OperationalError: database is locked

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\views\generic\base.py", line 143, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\views.py", line 32, in get
    service.update_holdings()
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\services\holding_service.py", line 19, in update_holdings
    prices = self.loader.load_prices()
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\services\data_loader.py", line 30, in load_prices
    Index.objects.get_or_create(
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 948, in get_or_create
    return self.get(**kwargs), False
           ^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 645, in get
    num = len(clone)
          ^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 382, in __len__
    self._fetch_all()
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 1928, in _fetch_all
    self._result_cache = list(self._iterable_class(self))
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 91, in __iter__
    results = compiler.execute_sql(
              ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\sql\compiler.py", line 1574, in execute_sql
    cursor.execute(sql, params)
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 122, in execute
    return super().execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\sqlite3\base.py", line 354, in execute
    return super().execute(query, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
django.db.utils.OperationalError: database is locked
"GET /holdings/ HTTP/1.1" 500 166439
Internal Server Error: /holdings/
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\sqlite3\base.py", line 354, in execute
    return super().execute(query, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlite3.OperationalError: database is locked

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\views\generic\base.py", line 143, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\views.py", line 32, in get
    service.update_holdings()
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\services\holding_service.py", line 19, in update_holdings
    prices = self.loader.load_prices()
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\services\data_loader.py", line 45, in load_prices
    MarketData.objects.create(
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
              ^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
              ^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 122, in execute
    return super().execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\sqlite3\base.py", line 354, in execute
    return super().execute(query, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
django.db.utils.OperationalError: database is locked
"GET /holdings/ HTTP/1.1" 500 182176
Internal Server Error: /holdings/
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\sqlite3\base.py", line 354, in execute
    return super().execute(query, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlite3.OperationalError: database is locked

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\views\generic\base.py", line 143, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\views.py", line 32, in get
    service.update_holdings()
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\services\holding_service.py", line 18, in update_holdings
    prices = self.loader.load_prices()
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\services\data_loader.py", line 30, in load_prices
    Index.objects.get_or_create(
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 948, in get_or_create
    return self.get(**kwargs), False
           ^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 645, in get
    num = len(clone)
          ^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 382, in __len__
    self._fetch_all()
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 1928, in _fetch_all
    self._result_cache = list(self._iterable_class(self))
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 91, in __iter__
    results = compiler.execute_sql(
              ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\sql\compiler.py", line 1574, in execute_sql
    cursor.execute(sql, params)
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 122, in execute
    return super().execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\sqlite3\base.py", line 354, in execute
    return super().execute(query, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
django.db.utils.OperationalError: database is locked
"GET /holdings/ HTTP/1.1" 500 166423
Internal Server Error: /holdings/
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\sqlite3\base.py", line 354, in execute
    return super().execute(query, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlite3.OperationalError: database is locked

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\views\generic\base.py", line 143, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\views.py", line 32, in get
    service.update_holdings()
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\services\holding_service.py", line 18, in update_holdings
    prices = self.loader.load_prices()
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\services\data_loader.py", line 45, in load_prices
    MarketData.objects.create(
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\base.py", line 892, in save
    self.save_base(
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\base.py", line 998, in save_base
    updated = self._save_table(
              ^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\base.py", line 1161, in _save_table
    results = self._do_insert(
              ^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\base.py", line 1202, in _do_insert
    return manager._insert(
           ^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\sql\compiler.py", line 1836, in execute_sql
    cursor.execute(sql, params)
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 122, in execute
    return super().execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\sqlite3\base.py", line 354, in execute
    return super().execute(query, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
django.db.utils.OperationalError: database is locked
"GET /holdings/ HTTP/1.1" 500 185376
Internal Server Error: /holdings/
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\sqlite3\base.py", line 354, in execute
    return super().execute(query, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlite3.OperationalError: database is locked

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\views\generic\base.py", line 143, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\views.py", line 32, in get
    service.update_holdings()
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\services\holding_service.py", line 20, in update_holdings
    prices = self.loader.load_prices()
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\services\data_loader.py", line 30, in load_prices
    Index.objects.get_or_create(
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 948, in get_or_create
    return self.get(**kwargs), False
           ^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 645, in get
    num = len(clone)
          ^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 382, in __len__
    self._fetch_all()
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 1928, in _fetch_all
    self._result_cache = list(self._iterable_class(self))
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 91, in __iter__
    results = compiler.execute_sql(
              ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\sql\compiler.py", line 1574, in execute_sql
    cursor.execute(sql, params)
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 122, in execute
    return super().execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\sqlite3\base.py", line 354, in execute
    return super().execute(query, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
django.db.utils.OperationalError: database is locked
Internal Server Error: /holdings/
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\sqlite3\base.py", line 354, in execute
    return super().execute(query, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlite3.OperationalError: database is locked

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\views\generic\base.py", line 143, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\views.py", line 32, in get
    service.update_holdings()
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\services\holding_service.py", line 20, in update_holdings
    prices = self.loader.load_prices()
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\services\data_loader.py", line 30, in load_prices
    Index.objects.get_or_create(
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 948, in get_or_create
    return self.get(**kwargs), False
           ^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 645, in get
    num = len(clone)
          ^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 382, in __len__
    self._fetch_all()
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 1928, in _fetch_all
    self._result_cache = list(self._iterable_class(self))
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 91, in __iter__
    results = compiler.execute_sql(
              ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\sql\compiler.py", line 1574, in execute_sql
    cursor.execute(sql, params)
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 122, in execute
    return super().execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\sqlite3\base.py", line 354, in execute
    return super().execute(query, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
django.db.utils.OperationalError: database is locked
Internal Server Error: /holdings/
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\sqlite3\base.py", line 354, in execute
    return super().execute(query, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlite3.OperationalError: database is locked

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\views\generic\base.py", line 143, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\views.py", line 32, in get
    service.update_holdings()
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\services\holding_service.py", line 20, in update_holdings
    prices = self.loader.load_prices()
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\services\data_loader.py", line 30, in load_prices
    Index.objects.get_or_create(
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 948, in get_or_create
    return self.get(**kwargs), False
           ^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 645, in get
    num = len(clone)
          ^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 382, in __len__
    self._fetch_all()
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 1928, in _fetch_all
    self._result_cache = list(self._iterable_class(self))
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 91, in __iter__
    results = compiler.execute_sql(
              ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\sql\compiler.py", line 1574, in execute_sql
    cursor.execute(sql, params)
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 122, in execute
    return super().execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\sqlite3\base.py", line 354, in execute
    return super().execute(query, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
django.db.utils.OperationalError: database is locked
"GET /holdings/ HTTP/1.1" 500 166503
"GET /holdings/ HTTP/1.1" 500 166503
"GET /holdings/ HTTP/1.1" 500 166355
Internal Server Error: /holdings/
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\sqlite3\base.py", line 354, in execute
    return super().execute(query, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlite3.OperationalError: database is locked

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\views\generic\base.py", line 143, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\views.py", line 32, in get
    service.update_holdings()
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\services\holding_service.py", line 20, in update_holdings
    prices = self.loader.load_prices()
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\services\data_loader.py", line 33, in load_prices
    index, created = Index.objects.get_or_create(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 948, in get_or_create
    return self.get(**kwargs), False
           ^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 645, in get
    num = len(clone)
          ^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 382, in __len__
    self._fetch_all()
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 1928, in _fetch_all
    self._result_cache = list(self._iterable_class(self))
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 91, in __iter__
    results = compiler.execute_sql(
              ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\sql\compiler.py", line 1574, in execute_sql
    cursor.execute(sql, params)
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 122, in execute
    return super().execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\backends\sqlite3\base.py", line 354, in execute
    return super().execute(query, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
django.db.utils.OperationalError: database is locked
"GET /holdings/ HTTP/1.1" 500 166878
Internal Server Error: /market-info/
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\views\generic\base.py", line 143, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\views.py", line 60, in get
    return render(request, 'market_info.html', {
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\shortcuts.py", line 25, in render
    content = loader.render_to_string(template_name, context, request, using=using)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\template\loader.py", line 61, in render_to_string
    template = get_template(template_name, using=using)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\template\loader.py", line 19, in get_template
    raise TemplateDoesNotExist(template_name, chain=chain)
django.template.exceptions.TemplateDoesNotExist: market_info.html
"GET /market-info/ HTTP/1.1" 500 94132
Internal Server Error: /market-info/
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\views\generic\base.py", line 143, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\views.py", line 58, in get
    calculator.calculate_basket_performances(basket.id, product.courant_date)
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\services\calculators\PerformanceCalculator.py", line 15, in calculate_basket_performances
    'today': MarketData.objects.get(index=index, data_type='ClosePrice', timestamp__date=current_date),
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 652, in get
    raise self.model.MultipleObjectsReturned(
product_manager.models.MarketData.MultipleObjectsReturned: get() returned more than one MarketData -- it returned 9!
Internal Server Error: /market-info/
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\views\generic\base.py", line 143, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\views.py", line 58, in get
    calculator.calculate_basket_performances(basket.id, product.courant_date)
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\services\calculators\PerformanceCalculator.py", line 15, in calculate_basket_performances
    'today': MarketData.objects.get(index=index, data_type='ClosePrice', timestamp__date=current_date),
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 652, in get
    raise self.model.MultipleObjectsReturned(
product_manager.models.MarketData.MultipleObjectsReturned: get() returned more than one MarketData -- it returned 9!
Internal Server Error: /market-info/
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\views\generic\base.py", line 143, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\views.py", line 58, in get
    calculator.calculate_basket_performances(basket.id, product.courant_date)
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\services\calculators\PerformanceCalculator.py", line 15, in calculate_basket_performances
    'today': MarketData.objects.get(index=index, data_type='ClosePrice', timestamp__date=current_date),
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 652, in get
    raise self.model.MultipleObjectsReturned(
product_manager.models.MarketData.MultipleObjectsReturned: get() returned more than one MarketData -- it returned 9!
Internal Server Error: /market-info/
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\views\generic\base.py", line 143, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\views.py", line 58, in get
    calculator.calculate_basket_performances(basket.id, product.courant_date)
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\services\calculators\PerformanceCalculator.py", line 15, in calculate_basket_performances
    'today': MarketData.objects.get(index=index, data_type='ClosePrice', timestamp__date=current_date),
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 652, in get
    raise self.model.MultipleObjectsReturned(
product_manager.models.MarketData.MultipleObjectsReturned: get() returned more than one MarketData -- it returned 9!
Internal Server Error: /market-info/
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\views\generic\base.py", line 143, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\views.py", line 58, in get
    calculator.calculate_basket_performances(basket.id, product.courant_date)
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\services\calculators\PerformanceCalculator.py", line 15, in calculate_basket_performances
    'today': MarketData.objects.get(index=index, data_type='ClosePrice', timestamp__date=current_date),
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 652, in get
    raise self.model.MultipleObjectsReturned(
product_manager.models.MarketData.MultipleObjectsReturned: get() returned more than one MarketData -- it returned 9!
"GET /market-info/ HTTP/1.1" 500 95431
Internal Server Error: /market-info/
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\views\generic\base.py", line 143, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\views.py", line 58, in get
    calculator.calculate_basket_performances(basket.id, product.courant_date)
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\services\calculators\PerformanceCalculator.py", line 15, in calculate_basket_performances
    'today': MarketData.objects.get(index=index, data_type='ClosePrice', timestamp__date=current_date),
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\db\models\query.py", line 652, in get
    raise self.model.MultipleObjectsReturned(
product_manager.models.MarketData.MultipleObjectsReturned: get() returned more than one MarketData -- it returned 9!
Internal Server Error: /market-info/
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\views\generic\base.py", line 143, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\views.py", line 55, in get
    calculator.calculate_basket_performances(product.courant_date)
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\services\calculators\PerformanceCalculator.py", line 21, in calculate_basket_performances
    for index in Index.objects.all():
                 ^^^^^
NameError: name 'Index' is not defined
"GET /market-info/ HTTP/1.1" 500 82596
Internal Server Error: /market-info/
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\views\generic\base.py", line 143, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\views.py", line 56, in get
    performances = calculator.calculate_performances(product.courant_date)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\services\calculators\PerformanceCalculator.py", line 26, in calculate_performances
    today_price = self.get_nearest_price(index.code, current_date)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\services\calculators\PerformanceCalculator.py", line 18, in get_nearest_price
    value = self.loader.get_price(index_code, check_date)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\services\data_loader.py", line 28, in get_price
    return df.loc[date, index_code]
           ~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\indexing.py", line 1183, in __getitem__
    return self.obj._get_value(*key, takeable=self._takeable)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\frame.py", line 4221, in _get_value
    row = self.index.get_loc(index)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\indexes\datetimes.py", line 627, in get_loc
    raise KeyError(key)
KeyError: datetime.date(2009, 1, 15)
"GET /market-info/ HTTP/1.1" 500 109595
Internal Server Error: /market-info/
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\views\generic\base.py", line 143, in dispatch
    return handler(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\views.py", line 56, in get
    performances = calculator.calculate_performances(product.courant_date)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\services\calculators\PerformanceCalculator.py", line 26, in calculate_performances
    today_price = self.get_nearest_price(index.code, current_date)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\services\calculators\PerformanceCalculator.py", line 18, in get_nearest_price
    value = self.loader.get_price(index_code, check_date)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\services\data_loader.py", line 28, in get_price
    return df.loc[date, index_code]
           ~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\indexing.py", line 1183, in __getitem__
    return self.obj._get_value(*key, takeable=self._takeable)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\frame.py", line 4221, in _get_value
    row = self.index.get_loc(index)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\indexes\datetimes.py", line 627, in get_loc
    raise KeyError(key)
KeyError: datetime.date(2009, 1, 15)
"GET /market-info/ HTTP/1.1" 500 109586
Internal Server Error: /api/market-data/ASX200/
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 983, in _cmp_method
    other = self._validate_comparison_value(other)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 542, in _validate_comparison_value
    raise InvalidComparison(other)
pandas.errors.InvalidComparison: 2008-01-22

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\views.py", line 89, in get_market_data
    mask = (df.index >= year_ago) & (df.index <= current_date)
            ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\indexes\base.py", line 7197, in _cmp_method
    result = op(self._values, other)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 985, in _cmp_method
    return invalid_comparison(self, other, op)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\invalid.py", line 40, in invalid_comparison
    raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
TypeError: Invalid comparison between dtype=datetime64[ns] and date
"GET /api/market-data/ASX200/ HTTP/1.1" 500 114898
Internal Server Error: /api/market-data/DAX/
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 983, in _cmp_method
    other = self._validate_comparison_value(other)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 542, in _validate_comparison_value
    raise InvalidComparison(other)
pandas.errors.InvalidComparison: 2008-01-22

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\views.py", line 89, in get_market_data
    mask = (df.index >= year_ago) & (df.index <= current_date)
            ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\indexes\base.py", line 7197, in _cmp_method
    result = op(self._values, other)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 985, in _cmp_method
    return invalid_comparison(self, other, op)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\invalid.py", line 40, in invalid_comparison
    raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
TypeError: Invalid comparison between dtype=datetime64[ns] and date
"GET /api/market-data/DAX/ HTTP/1.1" 500 114862
Internal Server Error: /api/market-data/FTSE100/
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 983, in _cmp_method
    other = self._validate_comparison_value(other)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 542, in _validate_comparison_value
    raise InvalidComparison(other)
pandas.errors.InvalidComparison: 2008-01-22

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\views.py", line 89, in get_market_data
    mask = (df.index >= year_ago) & (df.index <= current_date)
            ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\indexes\base.py", line 7197, in _cmp_method
    result = op(self._values, other)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 985, in _cmp_method
    return invalid_comparison(self, other, op)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\invalid.py", line 40, in invalid_comparison
    raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
TypeError: Invalid comparison between dtype=datetime64[ns] and date
"GET /api/market-data/FTSE100/ HTTP/1.1" 500 114910
Internal Server Error: /api/market-data/DAX/
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 983, in _cmp_method
    other = self._validate_comparison_value(other)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 542, in _validate_comparison_value
    raise InvalidComparison(other)
pandas.errors.InvalidComparison: 2008-01-22

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\views.py", line 89, in get_market_data
    mask = (df.index >= year_ago) & (df.index <= current_date)
            ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\indexes\base.py", line 7197, in _cmp_method
    result = op(self._values, other)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 985, in _cmp_method
    return invalid_comparison(self, other, op)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\invalid.py", line 40, in invalid_comparison
    raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
TypeError: Invalid comparison between dtype=datetime64[ns] and date
"GET /api/market-data/DAX/ HTTP/1.1" 500 114862
Internal Server Error: /api/market-data/ASX200/
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 983, in _cmp_method
    other = self._validate_comparison_value(other)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 542, in _validate_comparison_value
    raise InvalidComparison(other)
pandas.errors.InvalidComparison: 2008-01-22

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\views.py", line 89, in get_market_data
    mask = (df.index >= year_ago) & (df.index <= current_date)
            ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\indexes\base.py", line 7197, in _cmp_method
    result = op(self._values, other)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 985, in _cmp_method
    return invalid_comparison(self, other, op)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\invalid.py", line 40, in invalid_comparison
    raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
TypeError: Invalid comparison between dtype=datetime64[ns] and date
"GET /api/market-data/ASX200/ HTTP/1.1" 500 114898
Internal Server Error: /api/market-data/ASX200/
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 983, in _cmp_method
    other = self._validate_comparison_value(other)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 542, in _validate_comparison_value
    raise InvalidComparison(other)
pandas.errors.InvalidComparison: 2008-01-22

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\views.py", line 89, in get_market_data
    mask = (df.index >= year_ago) & (df.index <= current_date)
            ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\indexes\base.py", line 7197, in _cmp_method
    result = op(self._values, other)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 985, in _cmp_method
    return invalid_comparison(self, other, op)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\invalid.py", line 40, in invalid_comparison
    raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
TypeError: Invalid comparison between dtype=datetime64[ns] and date
"GET /api/market-data/ASX200/ HTTP/1.1" 500 114898
Internal Server Error: /api/market-data/DAX/
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 983, in _cmp_method
    other = self._validate_comparison_value(other)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 542, in _validate_comparison_value
    raise InvalidComparison(other)
pandas.errors.InvalidComparison: 2008-01-22

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\views.py", line 89, in get_market_data
    mask = (df.index >= year_ago) & (df.index <= current_date)
            ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\indexes\base.py", line 7197, in _cmp_method
    result = op(self._values, other)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 985, in _cmp_method
    return invalid_comparison(self, other, op)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\invalid.py", line 40, in invalid_comparison
    raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
TypeError: Invalid comparison between dtype=datetime64[ns] and date
"GET /api/market-data/DAX/ HTTP/1.1" 500 114862
Internal Server Error: /api/market-data/FTSE100/
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 983, in _cmp_method
    other = self._validate_comparison_value(other)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 542, in _validate_comparison_value
    raise InvalidComparison(other)
pandas.errors.InvalidComparison: 2008-01-22

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\views.py", line 89, in get_market_data
    mask = (df.index >= year_ago) & (df.index <= current_date)
            ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\indexes\base.py", line 7197, in _cmp_method
    result = op(self._values, other)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 985, in _cmp_method
    return invalid_comparison(self, other, op)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\invalid.py", line 40, in invalid_comparison
    raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
TypeError: Invalid comparison between dtype=datetime64[ns] and date
"GET /api/market-data/FTSE100/ HTTP/1.1" 500 114910
Internal Server Error: /api/market-data/DAX/
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 983, in _cmp_method
    other = self._validate_comparison_value(other)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 542, in _validate_comparison_value
    raise InvalidComparison(other)
pandas.errors.InvalidComparison: 2008-01-22

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\views.py", line 89, in get_market_data
    mask = (df.index >= year_ago) & (df.index <= current_date)
            ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\indexes\base.py", line 7197, in _cmp_method
    result = op(self._values, other)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 985, in _cmp_method
    return invalid_comparison(self, other, op)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\invalid.py", line 40, in invalid_comparison
    raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
TypeError: Invalid comparison between dtype=datetime64[ns] and date
"GET /api/market-data/DAX/ HTTP/1.1" 500 114862
Internal Server Error: /api/market-data/ASX200/
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 983, in _cmp_method
    other = self._validate_comparison_value(other)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 542, in _validate_comparison_value
    raise InvalidComparison(other)
pandas.errors.InvalidComparison: 2008-01-22

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\views.py", line 89, in get_market_data
    mask = (df.index >= year_ago) & (df.index <= current_date)
            ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\indexes\base.py", line 7197, in _cmp_method
    result = op(self._values, other)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 985, in _cmp_method
    return invalid_comparison(self, other, op)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\invalid.py", line 40, in invalid_comparison
    raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
TypeError: Invalid comparison between dtype=datetime64[ns] and date
"GET /api/market-data/ASX200/ HTTP/1.1" 500 114898
Internal Server Error: /api/market-data/SMI/
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 983, in _cmp_method
    other = self._validate_comparison_value(other)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 542, in _validate_comparison_value
    raise InvalidComparison(other)
pandas.errors.InvalidComparison: 2008-01-22

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\views.py", line 89, in get_market_data
    mask = (df.index >= year_ago) & (df.index <= current_date)
            ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\indexes\base.py", line 7197, in _cmp_method
    result = op(self._values, other)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 985, in _cmp_method
    return invalid_comparison(self, other, op)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\invalid.py", line 40, in invalid_comparison
    raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
TypeError: Invalid comparison between dtype=datetime64[ns] and date
Internal Server Error: /api/market-data/NASDAQ100/
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 983, in _cmp_method
    other = self._validate_comparison_value(other)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 542, in _validate_comparison_value
    raise InvalidComparison(other)
pandas.errors.InvalidComparison: 2008-01-22

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\views.py", line 89, in get_market_data
    mask = (df.index >= year_ago) & (df.index <= current_date)
            ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\indexes\base.py", line 7197, in _cmp_method
    result = op(self._values, other)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 985, in _cmp_method
    return invalid_comparison(self, other, op)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\invalid.py", line 40, in invalid_comparison
    raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
TypeError: Invalid comparison between dtype=datetime64[ns] and date
"GET /api/market-data/SMI/ HTTP/1.1" 500 114862
"GET /api/market-data/NASDAQ100/ HTTP/1.1" 500 114934
Internal Server Error: /api/market-data/ASX200/
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 983, in _cmp_method
    other = self._validate_comparison_value(other)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 542, in _validate_comparison_value
    raise InvalidComparison(other)
pandas.errors.InvalidComparison: 2008-01-22

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\views.py", line 89, in get_market_data
    mask = (df.index >= year_ago) & (df.index <= current_date)
            ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\indexes\base.py", line 7197, in _cmp_method
    result = op(self._values, other)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 985, in _cmp_method
    return invalid_comparison(self, other, op)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\invalid.py", line 40, in invalid_comparison
    raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
TypeError: Invalid comparison between dtype=datetime64[ns] and date
"GET /api/market-data/ASX200/ HTTP/1.1" 500 114898
Internal Server Error: /api/market-data/ASX200/
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 983, in _cmp_method
    other = self._validate_comparison_value(other)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 542, in _validate_comparison_value
    raise InvalidComparison(other)
pandas.errors.InvalidComparison: 2008-01-22

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\views.py", line 89, in get_market_data
    mask = (df.index >= year_ago) & (df.index <= current_date)
            ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\indexes\base.py", line 7197, in _cmp_method
    result = op(self._values, other)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 985, in _cmp_method
    return invalid_comparison(self, other, op)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\invalid.py", line 40, in invalid_comparison
    raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
TypeError: Invalid comparison between dtype=datetime64[ns] and date
"GET /api/market-data/ASX200/ HTTP/1.1" 500 114898
Internal Server Error: /api/market-data/ASX200/
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\views.py", line 92, in get_market_data
    mask = (pd.to_datetime(df.index) >= year_ago) & (pd.to_datetime(df.index) <= current_date)
            ^^
NameError: name 'pd' is not defined
"GET /api/market-data/ASX200/ HTTP/1.1" 500 70936
Internal Server Error: /api/market-data/ASX200/
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 983, in _cmp_method
    other = self._validate_comparison_value(other)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 542, in _validate_comparison_value
    raise InvalidComparison(other)
pandas.errors.InvalidComparison: 2008-01-22

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\views.py", line 93, in get_market_data
    mask = (pd.to_datetime(df.index) >= year_ago) & (pd.to_datetime(df.index) <= current_date)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\indexes\base.py", line 7197, in _cmp_method
    result = op(self._values, other)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 985, in _cmp_method
    return invalid_comparison(self, other, op)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\invalid.py", line 40, in invalid_comparison
    raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
TypeError: Invalid comparison between dtype=datetime64[ns] and date
"GET /api/market-data/ASX200/ HTTP/1.1" 500 114993
Internal Server Error: /api/market-data/ASX200/
"GET /api/market-data/ASX200/ HTTP/1.1" 500 97
Internal Server Error: /api/market-data/DAX/
"GET /api/market-data/DAX/ HTTP/1.1" 500 97
Internal Server Error: /api/market-data/FTSE100/
"GET /api/market-data/FTSE100/ HTTP/1.1" 500 97
Internal Server Error: /api/market-data/DAX/
"GET /api/market-data/DAX/ HTTP/1.1" 500 97
Internal Server Error: /api/market-data/ASX200/
"GET /api/market-data/ASX200/ HTTP/1.1" 500 97
Internal Server Error: /api/market-data/DAX/
"GET /api/market-data/DAX/ HTTP/1.1" 500 97
Internal Server Error: /api/market-data/FTSE100/
"GET /api/market-data/FTSE100/ HTTP/1.1" 500 97
Internal Server Error: /api/market-data/NASDAQ100/
"GET /api/market-data/NASDAQ100/ HTTP/1.1" 500 97
Internal Server Error: /api/market-data/FTSE100/
"GET /api/market-data/FTSE100/ HTTP/1.1" 500 97
Internal Server Error: /api/market-data/DAX/
"GET /api/market-data/DAX/ HTTP/1.1" 500 97
Internal Server Error: /api/market-data/SMI/
"GET /api/market-data/SMI/ HTTP/1.1" 500 97
Internal Server Error: /api/market-data/NASDAQ100/
"GET /api/market-data/NASDAQ100/ HTTP/1.1" 500 97
Internal Server Error: /api/market-data/ASX200/
"GET /api/market-data/ASX200/ HTTP/1.1" 500 97
Internal Server Error: /api/market-data/SMI/
Internal Server Error: /api/market-data/FTSE100/
"GET /api/market-data/SMI/ HTTP/1.1" 500 97
"GET /api/market-data/FTSE100/ HTTP/1.1" 500 97
Internal Server Error: /api/market-data/NASDAQ100/
"GET /api/market-data/NASDAQ100/ HTTP/1.1" 500 97
Internal Server Error: /api/market-data/DAX/
"GET /api/market-data/DAX/ HTTP/1.1" 500 97
Internal Server Error: /api/market-data/FTSE100/
"GET /api/market-data/FTSE100/ HTTP/1.1" 500 97
Internal Server Error: /api/market-data/NASDAQ100/
"GET /api/market-data/NASDAQ100/ HTTP/1.1" 500 97
Internal Server Error: /api/market-data/ASX200/
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 983, in _cmp_method
    other = self._validate_comparison_value(other)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 542, in _validate_comparison_value
    raise InvalidComparison(other)
pandas.errors.InvalidComparison: 2008-01-25

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\views.py", line 96, in get_market_data
    df_filtered = df[(df['date'] >= year_ago) & (df['date'] <= current_date)]
                      ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\series.py", line 6119, in _cmp_method
    res_values = ops.comparison_op(lvalues, rvalues, op)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\array_ops.py", line 330, in comparison_op
    res_values = op(lvalues, rvalues)
                 ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 985, in _cmp_method
    return invalid_comparison(self, other, op)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\invalid.py", line 40, in invalid_comparison
    raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
TypeError: Invalid comparison between dtype=datetime64[ns] and date
"GET /api/market-data/ASX200/ HTTP/1.1" 500 121153
Internal Server Error: /api/market-data/DAX/
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 983, in _cmp_method
    other = self._validate_comparison_value(other)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 542, in _validate_comparison_value
    raise InvalidComparison(other)
pandas.errors.InvalidComparison: 2008-01-25

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\views.py", line 96, in get_market_data
    df_filtered = df[(df['date'] >= year_ago) & (df['date'] <= current_date)]
                      ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\series.py", line 6119, in _cmp_method
    res_values = ops.comparison_op(lvalues, rvalues, op)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\array_ops.py", line 330, in comparison_op
    res_values = op(lvalues, rvalues)
                 ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 985, in _cmp_method
    return invalid_comparison(self, other, op)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\invalid.py", line 40, in invalid_comparison
    raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
TypeError: Invalid comparison between dtype=datetime64[ns] and date
"GET /api/market-data/DAX/ HTTP/1.1" 500 121117
Internal Server Error: /api/market-data/ASX200/
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 983, in _cmp_method
    other = self._validate_comparison_value(other)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 542, in _validate_comparison_value
    raise InvalidComparison(other)
pandas.errors.InvalidComparison: 2008-01-25

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\views.py", line 96, in get_market_data
    df_filtered = df[(df['date'] >= year_ago) & (df['date'] <= current_date)]
                      ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\series.py", line 6119, in _cmp_method
    res_values = ops.comparison_op(lvalues, rvalues, op)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\array_ops.py", line 330, in comparison_op
    res_values = op(lvalues, rvalues)
                 ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 985, in _cmp_method
    return invalid_comparison(self, other, op)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\invalid.py", line 40, in invalid_comparison
    raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
TypeError: Invalid comparison between dtype=datetime64[ns] and date
"GET /api/market-data/ASX200/ HTTP/1.1" 500 121170
Internal Server Error: /api/market-data/ASX200/
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 983, in _cmp_method
    other = self._validate_comparison_value(other)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 542, in _validate_comparison_value
    raise InvalidComparison(other)
pandas.errors.InvalidComparison: 2008-01-25

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\views.py", line 96, in get_market_data
    df_filtered = df[(df['date'] >= year_ago) & (df['date'] <= current_date)]
                      ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\series.py", line 6119, in _cmp_method
    res_values = ops.comparison_op(lvalues, rvalues, op)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\array_ops.py", line 330, in comparison_op
    res_values = op(lvalues, rvalues)
                 ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 985, in _cmp_method
    return invalid_comparison(self, other, op)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\invalid.py", line 40, in invalid_comparison
    raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
TypeError: Invalid comparison between dtype=datetime64[ns] and date
"GET /api/market-data/ASX200/ HTTP/1.1" 500 121170
Internal Server Error: /api/market-data/ASX200/
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 983, in _cmp_method
    other = self._validate_comparison_value(other)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 542, in _validate_comparison_value
    raise InvalidComparison(other)
pandas.errors.InvalidComparison: 2008-01-25

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\views.py", line 96, in get_market_data
    df_filtered = df[(df['date'] >= year_ago) & (df['date'] <= current_date)]
                      ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\series.py", line 6119, in _cmp_method
    res_values = ops.comparison_op(lvalues, rvalues, op)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\array_ops.py", line 330, in comparison_op
    res_values = op(lvalues, rvalues)
                 ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 985, in _cmp_method
    return invalid_comparison(self, other, op)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\invalid.py", line 40, in invalid_comparison
    raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
TypeError: Invalid comparison between dtype=datetime64[ns] and date
"GET /api/market-data/ASX200/ HTTP/1.1" 500 121183
Internal Server Error: /api/market-data/ASX200/
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 983, in _cmp_method
    other = self._validate_comparison_value(other)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 542, in _validate_comparison_value
    raise InvalidComparison(other)
pandas.errors.InvalidComparison: 2008-01-25

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\views.py", line 96, in get_market_data
    df_filtered = df[(df['Date'] >= year_ago) & (df['Date'] <= current_date)]
                      ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\series.py", line 6119, in _cmp_method
    res_values = ops.comparison_op(lvalues, rvalues, op)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\array_ops.py", line 330, in comparison_op
    res_values = op(lvalues, rvalues)
                 ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 985, in _cmp_method
    return invalid_comparison(self, other, op)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\invalid.py", line 40, in invalid_comparison
    raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
TypeError: Invalid comparison between dtype=datetime64[ns] and date
"GET /api/market-data/ASX200/ HTTP/1.1" 500 121183
Internal Server Error: /api/market-data/ASX200/
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 983, in _cmp_method
    other = self._validate_comparison_value(other)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 542, in _validate_comparison_value
    raise InvalidComparison(other)
pandas.errors.InvalidComparison: 2008-01-25

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\views.py", line 96, in get_market_data
    df_filtered = df[(df['Date'] >= year_ago) & (df['Date'] <= current_date)]
                      ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\series.py", line 6119, in _cmp_method
    res_values = ops.comparison_op(lvalues, rvalues, op)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\array_ops.py", line 330, in comparison_op
    res_values = op(lvalues, rvalues)
                 ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 985, in _cmp_method
    return invalid_comparison(self, other, op)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\invalid.py", line 40, in invalid_comparison
    raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
TypeError: Invalid comparison between dtype=datetime64[ns] and date
"GET /api/market-data/ASX200/ HTTP/1.1" 500 121184
Internal Server Error: /api/market-data/ASX200/
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 983, in _cmp_method
    other = self._validate_comparison_value(other)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 542, in _validate_comparison_value
    raise InvalidComparison(other)
pandas.errors.InvalidComparison: 2008-01-25

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\views.py", line 97, in get_market_data
    df_filtered = df[(df['date'] >= year_ago) & (df['date'] <= current_date)]
                      ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\series.py", line 6119, in _cmp_method
    res_values = ops.comparison_op(lvalues, rvalues, op)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\array_ops.py", line 330, in comparison_op
    res_values = op(lvalues, rvalues)
                 ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 985, in _cmp_method
    return invalid_comparison(self, other, op)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\invalid.py", line 40, in invalid_comparison
    raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
TypeError: Invalid comparison between dtype=datetime64[ns] and date
"GET /api/market-data/ASX200/ HTTP/1.1" 500 121201
Internal Server Error: /api/market-data/ASX200/
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 983, in _cmp_method
    other = self._validate_comparison_value(other)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 542, in _validate_comparison_value
    raise InvalidComparison(other)
pandas.errors.InvalidComparison: 2008-01-25

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\views.py", line 97, in get_market_data
    df_filtered = df[(df['date'] >= year_ago) & (df['date'] <= current_date)]
                      ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\series.py", line 6119, in _cmp_method
    res_values = ops.comparison_op(lvalues, rvalues, op)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\array_ops.py", line 330, in comparison_op
    res_values = op(lvalues, rvalues)
                 ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 985, in _cmp_method
    return invalid_comparison(self, other, op)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\invalid.py", line 40, in invalid_comparison
    raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
TypeError: Invalid comparison between dtype=datetime64[ns] and date
"GET /api/market-data/ASX200/ HTTP/1.1" 500 121170
Internal Server Error: /api/market-data/ASX200/
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 983, in _cmp_method
    other = self._validate_comparison_value(other)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 542, in _validate_comparison_value
    raise InvalidComparison(other)
pandas.errors.InvalidComparison: 2008-01-25

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\views.py", line 97, in get_market_data
    df_filtered = df[(df['date'] >= year_ago) & (df['date'] <= current_date)]
                      ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\series.py", line 6119, in _cmp_method
    res_values = ops.comparison_op(lvalues, rvalues, op)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\array_ops.py", line 330, in comparison_op
    res_values = op(lvalues, rvalues)
                 ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 985, in _cmp_method
    return invalid_comparison(self, other, op)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\invalid.py", line 40, in invalid_comparison
    raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
TypeError: Invalid comparison between dtype=datetime64[ns] and date
"GET /api/market-data/ASX200/ HTTP/1.1" 500 121189
Internal Server Error: /api/market-data/ASX200/
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 983, in _cmp_method
    other = self._validate_comparison_value(other)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 542, in _validate_comparison_value
    raise InvalidComparison(other)
pandas.errors.InvalidComparison: 2008-01-25

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\views.py", line 102, in get_market_data
    df_filtered = df[(df['date'] >= year_ago) & (df['date'] <= current_date)]
                      ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\series.py", line 6119, in _cmp_method
    res_values = ops.comparison_op(lvalues, rvalues, op)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\array_ops.py", line 330, in comparison_op
    res_values = op(lvalues, rvalues)
                 ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 985, in _cmp_method
    return invalid_comparison(self, other, op)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\invalid.py", line 40, in invalid_comparison
    raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
TypeError: Invalid comparison between dtype=datetime64[ns] and date
"GET /api/market-data/ASX200/ HTTP/1.1" 500 121462
Internal Server Error: /api/market-data/ASX200/
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 983, in _cmp_method
    other = self._validate_comparison_value(other)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 542, in _validate_comparison_value
    raise InvalidComparison(other)
pandas.errors.InvalidComparison: 2008-01-25

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\views.py", line 102, in get_market_data
    df_filtered = df[(df['date'] >= year_ago) & (df['date'] <= current_date)]
                      ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\series.py", line 6119, in _cmp_method
    res_values = ops.comparison_op(lvalues, rvalues, op)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\array_ops.py", line 330, in comparison_op
    res_values = op(lvalues, rvalues)
                 ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 985, in _cmp_method
    return invalid_comparison(self, other, op)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\invalid.py", line 40, in invalid_comparison
    raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
TypeError: Invalid comparison between dtype=datetime64[ns] and date
"GET /api/market-data/ASX200/ HTTP/1.1" 500 121357
Internal Server Error: /api/market-data/ASX200/
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 983, in _cmp_method
    other = self._validate_comparison_value(other)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 542, in _validate_comparison_value
    raise InvalidComparison(other)
pandas.errors.InvalidComparison: 2008-01-25

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\views.py", line 102, in get_market_data
    df_filtered = df[(df['date'] >= year_ago) & (df['date'] <= current_date)]
                      ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\series.py", line 6119, in _cmp_method
    res_values = ops.comparison_op(lvalues, rvalues, op)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\array_ops.py", line 330, in comparison_op
    res_values = op(lvalues, rvalues)
                 ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 985, in _cmp_method
    return invalid_comparison(self, other, op)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\invalid.py", line 40, in invalid_comparison
    raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
TypeError: Invalid comparison between dtype=datetime64[ns] and date
"GET /api/market-data/ASX200/ HTTP/1.1" 500 121300
Internal Server Error: /api/market-data/ASX200/
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 983, in _cmp_method
    other = self._validate_comparison_value(other)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 542, in _validate_comparison_value
    raise InvalidComparison(other)
pandas.errors.InvalidComparison: 2008-01-25

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\views.py", line 90, in get_market_data
    prices_data = loader.get_year_prices(index_code, current_date)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\services\data_loader.py", line 41, in get_year_prices
    mask = (df.index >= year_ago) & (df.index <= current_date)
            ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\indexes\base.py", line 7197, in _cmp_method
    result = op(self._values, other)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 985, in _cmp_method
    return invalid_comparison(self, other, op)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\invalid.py", line 40, in invalid_comparison
    raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
TypeError: Invalid comparison between dtype=datetime64[ns] and date
"GET /api/market-data/ASX200/ HTTP/1.1" 500 118433
Internal Server Error: /api/market-data/ASX200/
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 983, in _cmp_method
    other = self._validate_comparison_value(other)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 542, in _validate_comparison_value
    raise InvalidComparison(other)
pandas.errors.InvalidComparison: 2008-01-25

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\views.py", line 90, in get_market_data
    prices_data = loader.get_year_prices(index_code, current_date)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\services\data_loader.py", line 41, in get_year_prices
    mask = (df.index >= year_ago) & (df.index <= current_date)
            ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\indexes\base.py", line 7197, in _cmp_method
    result = op(self._values, other)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 985, in _cmp_method
    return invalid_comparison(self, other, op)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\invalid.py", line 40, in invalid_comparison
    raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
TypeError: Invalid comparison between dtype=datetime64[ns] and date
"GET /api/market-data/ASX200/ HTTP/1.1" 500 118455
Internal Server Error: /api/market-data/ASX200/
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 983, in _cmp_method
    other = self._validate_comparison_value(other)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 542, in _validate_comparison_value
    raise InvalidComparison(other)
pandas.errors.InvalidComparison: 2008-01-25

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\views.py", line 90, in get_market_data
    prices_data = loader.get_year_prices(index_code, current_date)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\services\data_loader.py", line 48, in get_year_prices
    mask = (df.index >= year_ago) & (df.index <= current_date)
            ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\indexes\base.py", line 7197, in _cmp_method
    result = op(self._values, other)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 985, in _cmp_method
    return invalid_comparison(self, other, op)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\invalid.py", line 40, in invalid_comparison
    raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
TypeError: Invalid comparison between dtype=datetime64[ns] and date
"GET /api/market-data/ASX200/ HTTP/1.1" 500 119410
Internal Server Error: /api/market-data/ASX200/
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 983, in _cmp_method
    other = self._validate_comparison_value(other)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 542, in _validate_comparison_value
    raise InvalidComparison(other)
pandas.errors.InvalidComparison: 2008-01-25

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\views.py", line 90, in get_market_data
    prices_data = loader.get_year_prices(index_code, current_date)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\services\data_loader.py", line 51, in get_year_prices
    mask = (df.index >= year_ago) & (df.index <= current_date)
            ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\indexes\base.py", line 7197, in _cmp_method
    result = op(self._values, other)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 985, in _cmp_method
    return invalid_comparison(self, other, op)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\invalid.py", line 40, in invalid_comparison
    raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
TypeError: Invalid comparison between dtype=datetime64[ns] and date
"GET /api/market-data/ASX200/ HTTP/1.1" 500 119314
Internal Server Error: /api/market-data/ASX200/
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 983, in _cmp_method
    other = self._validate_comparison_value(other)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 542, in _validate_comparison_value
    raise InvalidComparison(other)
pandas.errors.InvalidComparison: 2008-01-25

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\views.py", line 90, in get_market_data
    prices_data = loader.get_year_prices(index_code, current_date)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\services\data_loader.py", line 50, in get_year_prices
    mask = (df.index >= year_ago) & (df.index <= current_date)
            ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\indexes\base.py", line 7197, in _cmp_method
    result = op(self._values, other)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 985, in _cmp_method
    return invalid_comparison(self, other, op)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\invalid.py", line 40, in invalid_comparison
    raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
TypeError: Invalid comparison between dtype=datetime64[ns] and date
"GET /api/market-data/ASX200/ HTTP/1.1" 500 119355
Internal Server Error: /api/market-data/ASX200/
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 983, in _cmp_method
    other = self._validate_comparison_value(other)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 542, in _validate_comparison_value
    raise InvalidComparison(other)
pandas.errors.InvalidComparison: 2008-01-25

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\views.py", line 90, in get_market_data
    prices_data = loader.get_year_prices(index_code, current_date)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\services\data_loader.py", line 50, in get_year_prices
    mask = (df.index >= year_ago) & (df.index <= current_date)
            ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\indexes\base.py", line 7197, in _cmp_method
    result = op(self._values, other)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 985, in _cmp_method
    return invalid_comparison(self, other, op)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\invalid.py", line 40, in invalid_comparison
    raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
TypeError: Invalid comparison between dtype=datetime64[ns] and date
"GET /api/market-data/ASX200/ HTTP/1.1" 500 119315
Internal Server Error: /api/market-data/ASX200/
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 983, in _cmp_method
    other = self._validate_comparison_value(other)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 542, in _validate_comparison_value
    raise InvalidComparison(other)
pandas.errors.InvalidComparison: 2008-01-25

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\views.py", line 90, in get_market_data
    prices_data = loader.get_year_prices(index_code, current_date)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\services\data_loader.py", line 53, in get_year_prices
    mask = (df.index >= year_ago) & (df.index <= current_date)
            ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\indexes\base.py", line 7197, in _cmp_method
    result = op(self._values, other)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 985, in _cmp_method
    return invalid_comparison(self, other, op)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\invalid.py", line 40, in invalid_comparison
    raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
TypeError: Invalid comparison between dtype=datetime64[ns] and date
"GET /api/market-data/ASX200/ HTTP/1.1" 500 119426
Internal Server Error: /api/market-data/ASX200/
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 983, in _cmp_method
    other = self._validate_comparison_value(other)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 542, in _validate_comparison_value
    raise InvalidComparison(other)
pandas.errors.InvalidComparison: 2008-01-25

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\views.py", line 90, in get_market_data
    prices_data = loader.get_year_prices(index_code, current_date)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\services\data_loader.py", line 53, in get_year_prices
    mask = (df.index >= year_ago) & (df.index <= current_date)
            ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\indexes\base.py", line 7197, in _cmp_method
    result = op(self._values, other)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 985, in _cmp_method
    return invalid_comparison(self, other, op)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\invalid.py", line 40, in invalid_comparison
    raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
TypeError: Invalid comparison between dtype=datetime64[ns] and date
"GET /api/market-data/ASX200/ HTTP/1.1" 500 119426
Internal Server Error: /api/market-data/DAX/
Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 983, in _cmp_method
    other = self._validate_comparison_value(other)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 542, in _validate_comparison_value
    raise InvalidComparison(other)
pandas.errors.InvalidComparison: 2008-01-28

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\views.py", line 90, in get_market_data
    prices_data = loader.get_year_prices(index_code, current_date)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\structured_product\product_manager\services\data_loader.py", line 50, in get_year_prices
    mask = (df.index >= year_ago) & (df.index <= current_date)
            ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\indexes\base.py", line 7197, in _cmp_method
    result = op(self._values, other)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 985, in _cmp_method
    return invalid_comparison(self, other, op)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC\PycharmProjects\tests\ApplicationProduitStructures\pythonProject\.venv\Lib\site-packages\pandas\core\ops\invalid.py", line 40, in invalid_comparison
    raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
TypeError: Invalid comparison between dtype=datetime64[ns] and date
"GET /api/market-data/DAX/ HTTP/1.1" 500 119250
